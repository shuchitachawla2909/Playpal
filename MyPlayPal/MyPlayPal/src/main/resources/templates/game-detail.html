<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title th:text="${sport.sportname} + ' - Details'">Game Details</title>

    <!-- Global Styles -->
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #fafafa;
            margin: 0;
        }

        .page-header {
            background-color: var(--primary-color);
            color: #fff;
            text-align: center;
            padding: 60px 20px;
        }

        .page-header h1 {
            font-size: 2.4rem;
            margin-bottom: 10px;
        }

        .page-section {
            padding: 60px 5%;
            background-color: #fafafa;
        }

        .section-title {
            text-align: center;
            margin-bottom: 40px;
            font-size: 2em;
            color: #333;
            font-weight: 600;
        }

        /* Card container */
        .card-container {
            display: flex;
            flex-wrap: wrap;
            gap: 50px;
            justify-content: center;
        }

        /* Common card style for venues & events */
        .card {
            width: 300px;
            border-radius: 12px;
            overflow: hidden;
            background: #fff;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            text-align: center;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        }

        .card img {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }

        .card-body {
            padding: 15px;
            background-color: #f8f8f8;
        }

        .card-body h3 {
            margin: 10px 0 5px;
            font-size: 1.2em;
            color: #222;
        }

        .card-body p {
            color: #666;
            margin-bottom: 10px;
            font-size: 0.95em;
        }

        /* Book Now button */
        .book-btn {
            display: inline-block;
            padding: 8px 16px;
            background-color: var(--secondary-color);
            color: white;
            border-radius: 8px;
            text-decoration: none;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }

        .book-btn:hover {
            background-color: #e67e22;
        }

        /* Rating badge */
        .rating-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-weight: bold;
            font-size: 12px;
            min-width: 30px;
            text-align: center;
        }

        .rating-high { background: #27ae60; }
        .rating-medium { background: #f39c12; }
        .rating-low { background: #e74c3c; }
        .rating-new { background: #95a5a6; }

        .no-data {
            text-align: center;
            font-size: 1.1em;
            color: #777;
        }

        footer {
            background-color: var(--primary-color);
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: 60px;
        }

        footer .footer-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 1.2em;
        }

        footer .footer-logo i {
            color: #28a745;
        }
    </style>
</head>

<body>

<!-- Navigation -->
<nav class="navbar">
    <div class="nav-container">
        <div class="nav-logo">
            <i class="fas fa-futbol"></i>
            <span>PlayPal</span>
        </div>
        <div class="nav-menu" id="nav-menu">
            <a th:href="@{/}" class="nav-link">Home</a>
            <a th:href="@{/venues}" class="nav-link">Book</a>
            <a th:href="@{/events}" class="nav-link">Events</a>
            <a th:href="@{/games}" class="nav-link">Games</a>
            <a th:href="@{/about}" class="nav-link">About</a>
            <a th:href="@{/contact}" class="nav-link">Contact</a>
            <!-- start: replace this block inside your nav -->
            <div class="nav-auth" id="nav-auth">
                <!-- When authenticated, show profile + logout -->
                <div sec:authorize="isAuthenticated()" class="mydiv">

                    <a sec:authorize="hasRole('USER')" th:href="@{/profile}" class="nav-link">
                        <img th:src="${currentUser!=null and currentUser.profilePictureUrl != null} ? ${currentUser.profilePictureUrl} : @{/images/default-avatar.jpeg}"
                             alt="Profile" class="nav-avatar">
                    </a>

                    <a sec:authorize="hasRole('MANAGER')" th:href="@{/manager/profile}" class="nav-link">
                        <img th:src="@{/images/default-avatar.jpeg}" alt="Manager Profile" class="nav-avatar">
                    </a>

                    <form th:action="@{/logout}" method="post" style="display:inline-block">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                        <button type="submit" class="nav-link logout-btn">
                            Logout
                        </button>
                    </form>
                </div>

                <!-- when not authenticated show login/signup -->
                <div th:unless="${authenticated}">
                    <a th:href="@{/login}" class="nav-link login-btn">Login</a>
                    <a th:href="@{/signup}" class="signup-link signup-btn active">Sign Up</a>
                </div>
            </div>
            <!-- end: replace -->

        </div>
        <div class="nav-hamburger" id="nav-hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>
</nav>

<!-- ✅ Page Header -->
<section class="page-header">
    <h1 th:text="${sport.sportname}">Sport Name</h1>
</section>

<!-- ✅ Venues Section -->
<section class="page-section">
    <h2 class="section-title">Venues Offering This Sport</h2>

    <div th:if="${#lists.isEmpty(venues)}" class="no-data">
        <p>No venues found for this sport.</p>
    </div>

    <div class="card-container" th:if="${!#lists.isEmpty(venues)}">
        <div th:each="venue : ${venues}" class="card">
            <img th:src="@{${venue.venueImageUrl}}" alt="Venue Image">

            <div class="card-body">
                <h3 th:text="${venue.venuename}">Venue Name</h3>
                <p th:text="'City: ' + ${venue.city}">City</p>
                <p th:text="'Address: ' + ${venue.address}">Address</p>

                <a th:href="@{/venues/{id}(id=${venue.id})}" class="book-btn">
                    Book Now
                </a>

                <div th:if="${venue.rating != null and venue.rating >= 4}" class="rating-badge rating-high">
                    <span th:text="${#numbers.formatDecimal(venue.rating, 1, 1)}">4.3</span>
                </div>
                <div th:if="${venue.rating != null and venue.rating >= 3 and venue.rating < 4}" class="rating-badge rating-medium">
                    <span th:text="${#numbers.formatDecimal(venue.rating, 1, 1)}">3.5</span>
                </div>
                <div th:if="${venue.rating != null and venue.rating < 3}" class="rating-badge rating-low">
                    <span th:text="${#numbers.formatDecimal(venue.rating, 1, 1)}">2.5</span>
                </div>
                <div th:if="${venue.rating == null}" class="rating-badge rating-new">
                    <span>New</span>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- ✅ Events Section -->
<section class="page-section" style="background:#fff;">
    <h2 class="section-title">Confirmed Events</h2>

    <div th:if="${#lists.isEmpty(events)}" class="no-data">
        <p>No confirmed events or slots are available for this sport right now.</p>
    </div>

    <div class="card-container" th:if="${!#lists.isEmpty(events)}">
        <div th:each="event : ${events}" class="card">
            <div class="card-body">
                <h3 th:text="${event.eventName}">Event Name</h3>
                <p th:text="'Players: ' + ${event.currentPlayers} + '/' + ${event.maxPlayers}">Players</p>
                <p th:text="'Entry Fee: ₹' + ${event.entryFee}">Fee</p>
                <p th:text="'Skill Level: ' + ${event.skillLevelRequired}">Skill</p>

                <a th:href="@{/events/{id}(id=${event.id})}" class="book-btn">View Details</a>

                <a sec:authorize="isAnonymous()"
                   th:href="@{/login}"
                   class="book-btn"
                   style="background-color:#007bff; margin-top:10px;">
                    Login to Book
                </a>
            </div>
        </div>
    </div>
</section>

<!-- ✅ Footer -->
<footer>
    <div class="footer-logo">
        <i class="fas fa-futbol"></i>
        <span>PlayPal</span>
    </div>
    <p>&copy; 2025 PlayPal. All rights reserved.</p>
</footer>

</body>
</html>

