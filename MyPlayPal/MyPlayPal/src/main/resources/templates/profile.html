<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Profile - PlayPal</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
<!-- Navigation -->
<nav class="navbar">
    <div class="nav-container">
        <div class="nav-logo">
            <i class="fas fa-futbol"></i>
            <span>PlayPal</span>
        </div>
        <div class="nav-menu" id="nav-menu">
            <a th:href="@{/}" class="nav-link">Home</a>
            <a th:href="@{/venues}" class="nav-link">Book</a>
            <a th:href="@{/events}" class="nav-link">Events</a>
            <a th:href="@{/games}" class="nav-link">Games</a>
            <a th:href="@{/about}" class="nav-link">About</a>
            <a th:href="@{/contact}" class="nav-link">Contact</a>
            <!-- start: replace this block inside your nav -->
            <div class="nav-auth" id="nav-auth">
                <!-- When authenticated, show profile + logout -->
                <div sec:authorize="isAuthenticated()" class="mydiv">

                    <a sec:authorize="hasRole('USER')" th:href="@{/profile}" class="nav-link">
                        <img th:src="${currentUser.profilePictureUrl != null} ? ${currentUser.profilePictureUrl} : @{/images/default-avatar.jpeg}"
                             alt="Profile" class="nav-avatar">
                    </a>

                    <a sec:authorize="hasRole('MANAGER')" th:href="@{/manager/profile}" class="nav-link">
                        <img th:src="@{/images/default-avatar.jpeg}" alt="Manager Profile" class="nav-avatar">
                    </a>

                    <form th:action="@{/logout}" method="post" style="display:inline-block">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                        <button type="submit" class="nav-link logout-btn">
                            Logout
                        </button>
                    </form>
                </div>

                <!-- when not authenticated show login/signup -->
                <div th:unless="${authenticated}">
                    <a th:href="@{/login}" class="nav-link login-btn">Login</a>
                    <a th:href="@{/signup}" class="signup-link signup-btn active">Sign Up</a>
                </div>
            </div>
            <!-- end: replace -->

        </div>
        <div class="nav-hamburger" id="nav-hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>
</nav>


<section class="profile-section">
    <div class="container" style="max-width: 1000px;">
        <div style="background-color: var(--white); padding: 40px; border-radius: var(--border-radius); box-shadow: var(--box-shadow); margin-bottom: 40px;">
            <h2>Your Profile</h2>
            <div style="text-align: center; margin: 20px 0;">
                <img th:src="${user.profilePictureUrl != null} ? ${user.profilePictureUrl} : @{/images/default-avatar.jpeg}" alt="avatar" style="width:100px;height:100px;border-radius:50%; border: 3px solid var(--secondary-color); object-fit: cover;">
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px;">
                <p><strong>Username:</strong> <span th:text="${user.username}"></span></p>
                <p><strong>Email:</strong> <span th:text="${user.email}"></span></p>
                <p><strong>Contact:</strong> <span th:text="${user.contact}"></span></p>
                <p><strong>City:</strong> <span th:text="${user.city}"></span></p>
                <p><strong>State:</strong> <span th:text="${user.state}"></span></p>
                <p><strong>Age:</strong> <span th:text="${user.age}"></span></p>
            </div>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
            <div style="background-color: var(--white); padding: 30px; border-radius: var(--border-radius); box-shadow: var(--box-shadow);">
                <h2 style="color: var(--primary-color); margin-bottom: 20px; border-bottom: 2px solid var(--secondary-color); padding-bottom: 10px;">
                    <i class="fas fa-calendar-plus"></i> Events Created
                </h2>
                <div th:if="${eventsCreated != null and !eventsCreated.isEmpty()}">
                    <div th:each="event : ${eventsCreated}" style="background-color: var(--light-bg); padding: 15px; margin-bottom: 15px; border-radius: var(--border-radius);">
                        <h4 style="margin: 0 0 10px 0;">
                            <a th:href="@{/events/{id}(id=${event.id})}" style="color: var(--heading-color); text-decoration: none;">
                                <span th:text="${event.eventName}">Event Name</span>
                            </a>
                        </h4>
                        <p style="margin: 5px 0; font-size: 0.9rem; color: var(--text-color);">
                            <i class="fas fa-users"></i> <span th:text="${event.currentPlayers} + '/' + ${event.maxPlayers}">5/10</span> players
                        </p>
                        <p style="margin: 5px 0; font-size: 0.9rem; color: var(--text-color);">
                            <i class="fas fa-rupee-sign"></i> â‚¹<span th:text="${event.entryFee}">200</span>
                        </p>
                    </div>
                </div>
                <p th:if="${eventsCreated == null or eventsCreated.isEmpty()}" style="text-align: center; color: var(--text-color); padding: 20px;">
                    <i class="fas fa-calendar-times" style="font-size: 2rem; color: #ccc; display: block; margin-bottom: 10px;"></i>
                    No events created yet.
                </p>
            </div>

            <div style="background-color: var(--white); padding: 30px; border-radius: var(--border-radius); box-shadow: var(--box-shadow);">
                <h2 style="color: var(--primary-color); margin-bottom: 20px; border-bottom: 2px solid var(--secondary-color); padding-bottom: 10px;">
                    <i class="fas fa-user-check"></i> Events Joined
                </h2>
                <div th:if="${eventsJoined != null and !eventsJoined.isEmpty()}">
                    <div th:each="participant : ${eventsJoined}" style="background-color: var(--light-bg); padding: 15px; margin-bottom: 15px; border-radius: var(--border-radius);">
                        <h4 style="margin: 0 0 10px 0;">
                            <a th:href="@{/events/{id}(id=${participant.event.id})}" style="color: var(--heading-color); text-decoration: none;">
                                <span th:text="${participant.event.eventName}">Event Name</span>
                            </a>
                        </h4>
                        <p style="margin: 5px 0; font-size: 0.9rem; color: var(--text-color);">
                            <i class="fas fa-user"></i> Organizer: <span th:text="${participant.event.organizer.username}">Username</span>
                        </p>
                        <p style="margin: 5px 0; font-size: 0.9rem; color: var(--text-color);">
                            <i class="fas fa-info-circle"></i> Status: <span th:text="${participant.status}">JOINED</span>
                        </p>
                    </div>
                </div>
                <p th:if="${eventsJoined == null or eventsJoined.isEmpty()}" style="text-align: center; color: var(--text-color); padding: 20px;">
                    <i class="fas fa-calendar-times" style="font-size: 2rem; color: #ccc; display: block; margin-bottom: 10px;"></i>
                    No events joined yet.
                </p>
            </div>
        </div>
    </div>
</section>

</body>
</html>
