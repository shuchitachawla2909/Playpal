<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <title>Available Venues</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        .card-container {
            display: flex;
            flex-wrap: wrap;
            gap: 50px;
            padding:5%;
        }
        .card {
            width: 300px;
            height: 300px;
            border: 1px solid #ccc;
            border-radius: 12px;
            overflow: hidden;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            background: #fff;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            position: relative;
        }
        .card img {
            width: 100%;
            height: 70%;
            object-fit: cover;
        }
        .card-body {
            padding: 10px;
            height: 30%;
            background: #f8f8f8;
            position: relative;
        }
        .card-body h3 {
            margin: 0;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0px 6px 12px rgba(0,0,0,0.15);
        }

        /* ✅ ADDED: Rating Badge Styles - Bottom Right Corner */
        .rating-badge {
            position: absolute;
            bottom: 10px;
            right: 10px;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-weight: bold;
            font-size: 12px;
            min-width: 30px;
            text-align: center;
        }
        .rating-high { background: #27ae60; }
        .rating-medium { background: #f39c12; }
        .rating-low { background: #e74c3c; }
        .rating-new { background: #95a5a6; }
    </style>
</head>
<body>
<!-- Navigation -->
<nav class="navbar">
    <div class="nav-container">
        <div class="nav-logo">
            <i class="fas fa-futbol"></i>
            <span>PlayPal</span>
        </div>
        <div class="nav-menu" id="nav-menu">
            <a th:href="@{/}" class="nav-link active">Home</a>
            <a th:href="@{/venues}" class="nav-link">Book</a>
            <a th:href="@{/games}" class="nav-link">Games</a>
            <a th:href="@{/about}" class="nav-link">About</a>
            <a th:href="@{/contact}" class="nav-link">Contact</a>
            <div class="nav-auth" id="nav-auth">
                <div sec:authorize="isAuthenticated()" class="mydiv">
                    <a sec:authorize="hasRole('USER')" th:href="@{/profile}" class="nav-link">
                        <img th:src="${currentUser.profilePictureUrl != null} ? ${currentUser.profilePictureUrl} : @{/images/default-avatar.jpeg}"
                             alt="Profile" class="nav-avatar">
                    </a>
                    <a sec:authorize="hasRole('MANAGER')" th:href="@{/manager/profile}" class="nav-link">
                        <img th:src="@{/images/default-avatar.jpeg}" alt="Manager Profile" class="nav-avatar">
                    </a>
                    <form th:action="@{/logout}" method="post" style="display:inline-block">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                        <button type="submit" class="nav-link logout-btn">
                            Logout
                        </button>
                    </form>
                </div>
                <div th:unless="${authenticated}">
                    <a th:href="@{/login}" class="nav-link login-btn">Login</a>
                    <a th:href="@{/signup}" class="signup-link signup-btn active">Sign Up</a>
                </div>
            </div>
        </div>
        <div class="nav-hamburger" id="nav-hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>
</nav>

<!-- Page Header -->
<section class="page-header">
    <div class="container">
        <h1>Available Venues</h1>
        <p>Find and book the perfect venue for your next game</p>
    </div>
</section>

<div class="card-container">
    <a th:href="@{/venues/{id}(id=${venue.id})}" class="card" th:each="venue : ${venues}">
        <img th:src="@{${venue.venueImageUrl}}" alt="Venue Image">
        <div class="card-body">
            <h3 th:text="${venue.venuename}"></h3>
            <p th:text="${venue.city}"></p>

            <!-- ✅ ADDED: Rating Badges - Bottom Right Corner -->
            <div th:if="${venue.rating != null and venue.rating >= 4}" class="rating-badge rating-high">
                <span th:text="${#numbers.formatDecimal(venue.rating, 1, 1)}">4.3</span>
            </div>
            <div th:if="${venue.rating != null and venue.rating >= 3 and venue.rating < 4}" class="rating-badge rating-medium">
                <span th:text="${#numbers.formatDecimal(venue.rating, 1, 1)}">3.5</span>
            </div>
            <div th:if="${venue.rating != null and venue.rating < 3}" class="rating-badge rating-low">
                <span th:text="${#numbers.formatDecimal(venue.rating, 1, 1)}">2.5</span>
            </div>
            <div th:if="${venue.rating == null}" class="rating-badge rating-new">
                <span>New</span>
            </div>
        </div>
    </a>
</div>

<footer class="footer">
    <div class="container">
        <div class="footer-content">
            <div class="footer-logo">
                <i class="fas fa-futbol"></i>
                <span>PlayPal</span>
            </div>
            <p>&copy; 2025 PlayPal. All rights reserved.</p>
        </div>
    </div>
</footer>
</body>
</html>